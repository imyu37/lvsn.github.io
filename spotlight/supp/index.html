<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="./favicon.ico">

    <title>SpotLight: Shadow-Guided Object Relighting via Diffusion &mdash; Supplementary Material</title>

    <!-- Bootstrap core CSS -->
    <link href="./css/bootstrap.min.css" rel="stylesheet">
    <link href="./css/lightbox.min.css" rel="stylesheet">

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Custom styles for this template -->
    <link href="./css/sticky-footer-navbar.css" rel="stylesheet">
    <style>
      /* Center and constrain the table */
      #results-container {
        display: flex;
        flex-wrap: wrap;
        justify-content: center; /* Center align items horizontally */
        max-width: 100%; /* Constrain overall width */
        margin: 0 auto; /* Center align the container itself */
      }
  
      .result-cell {
        flex: 1 0 220px; /* Flexible size with minimum 220px */
        max-width: 220px; /* Prevent over-expansion */
        margin: 0px; /* Space between cells */
        overflow: hidden;
        border: 1px solid #ddd;
        text-align: center;
        padding: 0;
      }
  
      .img-container {
        position: relative;
        width: 100%;
        height: 220px;
      }
  
      .result-cell img {
        width: 100%;
        height: auto;
        position: absolute;
        top: 0;
        left: 0;
      }
  
      .method-label {
        text-align: center;
        margin-top: 5px;
      }
  
      .row.mb-3 {
        width: 100%;
        justify-content: center; /* Align rows to center */
      }

      figurecaption {
        text-align: center;
        display: block;
      }
    </style>
  </head>
  <body>

    <header>
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <a class="navbar-brand" href="#">Supplementary Material</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-expanded="false" aria-controls="navbarCollapse" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
          <!-- <a class="navbar-brand" href="#">Sticky footer</a> -->
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="#qual_results_control">Qualitative results</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#parameter_control">Parameter control</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#virtual_light_source">Virtual light source</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#compositing_2d">2D object relighting</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#implementation">Implementation details</span></a>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <!-- Begin page content -->
    <div class="container">
      <div class="mt-1">
        <h1>SpotLight: Shadow-Guided Object Relighting via Diffusion &mdash; Supplementary Material</h1>
      </div>
      <p align="justify" class="lead">
        We present additional results complementing the main paper. In sections 1-3, to adequately show the control our method offers, we use the "user-controlled" version
        of our evaluation dataset along with pre-computed method outputs. You will be able to experience the control our method provides by hovering over the images or using
        sliders.
      </p>

      <div style="clear:both; height:2em;"></div>
      <h3>Table of Contents</h3>
      <p>
      <ol>
        <li>
          <a href="#qual_results_control">Additional qualitative results (extends fig. 5)</a>
        </li>
        <li>
          <a href="#parameter_control">Parameter control (extends sec. 4.6)</a>
        </li>
        <li>
          <a href="#virtual_light_source">Virtual light source adjustments</a>
        </li>
        <li>
          <a href="#compositing_2d">2D object relighting</a>
        </li>  
        <li>
          <a href="#background_relighting">Background relighting</span></a>
        </li>        
      </ol>
      </p>

      <a class="anchor" name="qual_results_control"></a>
      <div style="clear:both; height:4em;"></div>
      <h2>1. Additional qualitative results</h2>
      <p align="justify">We present additional randomly-selected results on the "user-controlled" dataset, extending the qualitative results from fig. 5.
        In this case, we rendered 8 light directions instead
        of 5 (as used for the user study), in order to also show results where the shadow is behind the object.
        Please move your mouse from left to right over the images to see the light direction change.
      </p>

      <div id="results-container-fig-5-ext" class="row"></div>


      <a class="anchor" name="parameter_control"></a>
      <div style="clear:both; height:4em;"></div>
      <h2>2. Additional results for parameter control</h2>
      <p align="justify">
        We show how the two main parameters of our method can be adjusted to obtain various styles, extending sec. 4.6.
        Here, we show the adjustment of both parameters separately, but they could easily be adjusted simultaneously for optimal results.
      </p>
      <h3>2.1. Guidance scale γ</h3>
      <p align="justify">Here, we show control over the guidance scale γ, extending fig. 6. By using the sliders, the light direction and the guidance scale can be adjusted.
        Increasing the guidance scale generally makes the dominant light source stronger.
      </p>
      <p>The current light azimuth angle is <input type="range" min="0" max="7" value="0" class="slider" id="cfg-azimuth-slider" draggable/> <strong id="cfg-azimuth-value">0°</strong>.</p>
      <p align="justify">The current guidance scale is <input type="range" min="0" max="2" value="1" class="slider" id="cfg-gamma-slider" draggable/> <strong id="cfg-gamma-value">γ=3.0</strong>.</p>
      <div id="results-container-cfg" class="row"></div>

      <h3>2.2. Latent mask weight β</h3>
      <p align="justify">Here, we show control over the latent mask weight β, extending fig. 7. 
        Increasing the latent mask weight makes the dominant shadow darker.        
      </p>
      <p>The current light azimuth angle is <input type="range" min="0" max="7" value="0" class="slider" id="latent-weight-azimuth-slider" draggable/> <strong id="latent-weight-azimuth-value">0°</strong>.</p>
      <p align="justify">The current latent weight is <input type="range" min="0" max="2" value="1" class="slider" id="latent-weight-slider" draggable/> <strong id="latent-weight-value">β=0.05</strong>.</p>
      <div id="results-container-latent-weight" class="row"></div>
       

      <a class="anchor" name="virtual_light_source"></a>
      <div style="clear:both; height:4em;"></div>
      <h2>3. Virtual light source adjustments</h2>
      <p align="justify">Here, we demonstrate the impact of adjusting two parameters of the spherical light source that generated the shadow: its elevation and its radius.
      Even though SpotLight doesn't directly have access to those parameters, the shadow is a good proxy for correctly relighting the object.</p>
      <h3>3.1 Light source radius</h3>
      <p align="justify">We adjust the light source radius. Small radius leads to hard shadows, whereas higher radii generate more diffuse shadows.

      </p>
      <p>The current light azimuth angle is <input type="range" min="0" max="7" value="0" class="slider" id="light-size-azimuth-slider" draggable/> <strong id="light-size-azimuth-value">0°</strong>.</p>
      <p align="justify">The current light radius is <input type="range" min="0" max="2" value="1" class="slider" id="light-size-slider" draggable/> <strong id="light-size-value">γ=3.0</strong> (at a distance of 10 from the object).</p>
      <div id="results-container-light-size" class="row"></div>

      <a class="anchor" name="compositing_2d"></a>
      <div style="clear:both; height:4em;"></div>
      <h2>4. 2D object relighting</h2>

      <p>Adjust the lighting position (shadow from left to right in pixel height space): <input type="range" min="0" max="5" value="0" class="slider" id="compositing-2d-azimuth-slider" draggable/></p>
      <p>TODO.</p>
      <div id="results-container-compositing-2d" class="row"></div>

      
      
      <a class="anchor" name="multiple_lights"></a>
      <div style="clear:both; height:4em;"></div>
      <h2>4. Multiple lights</h2>

      <p>TODO - 2 examples.</p>

      
    <a class="anchor" name="implementation"></a>
    <div style="clear:both; height:4em;"></div>
    <h2>5. Background relighting</h2>
    <p>TODO - 1 example.</p>
    <p>The current light azimuth angle is <input type="range" min="0" max="7" value="0" class="slider" id="bg-relight-azimuth-slider" draggable/> <strong id="bg-relight-azimuth-value">0°</strong>.</p>
    <div id="results-container-bg-relight" class="row"></div>

    <a class="anchor" name="user_study"></a>
    <div style="clear:both; height:4em;"></div>
    <h2>6. User study</h2>
    <p>Here, we show the user interface used to perform our human perceptual study, as described in sec. 4.5 in the paper. The user is first shown an instructions page, followed by the questions page (which is the same for the 120 2AFC questions).</p>
    <div class="row">
      <div class="col-md-12">
        <a href="figures/user_study/instructions.png" target="_blank">
          <img src="figures/user_study/instructions.png" class="border border-secondary" alt="User study instructions" style="width: 100%;">
        </a>
        <figurecaption>User study intructions page</figurecaption>
      </div>
    </div>
    <br>
    <br>
    <div class="row">
      <div class="col-md-12">
        <a href="figures/user_study/question.png" target="_blank">
          <img src="figures/user_study/question.png" class="border border-secondary" alt="User study question" style="width: 100%;">
        </a>
        <figurecaption>User study question page</figurecaption>
      </div>
    </div>
    <br>
    <br>


    <footer class="footer navbar-fixed-bottom" style="left: 0">
      <div class="container">
        <span class="text-muted">SpotLight: Shadow-Guided Object Relighting via Diffusion &mdash; Supplementary Material</span>
      </div>
    </footer>
  <script src="./js/custom/additional_qual.js"></script>
  <script src="./js/custom/custom_exp.js"></script>
  <script>
    
    makeResultsTable2({
        resultsContainer: document.getElementById('results-container-cfg'),
        azimuthSlider: document.getElementById('cfg-azimuth-slider'),
        azimuthValueText: document.getElementById('cfg-azimuth-value'),
        parameterSlider: document.getElementById('cfg-gamma-slider'),
        parameterValueText: document.getElementById('cfg-gamma-value'),
        methods: [
        'shadow_comp_v2_cfg_1_post_color_balanced_denoised',
        'shadow_comp_v2_default_post_color_balanced_denoised',
        'shadow_comp_v2_cfg_7_post_color_balanced_denoised',
        ],
        cropNames: ["AG8A6551-16ae8050c9_06_crop_B075X4QFK2", "9C4A8239-7a9d7093e2_04_crop_B082VLJ7Y2", "9C4A0566-a088c98ccf_05_crop_B07VKM698C", "9C4A3419-2e5c9b4d85_08_crop_B07B4D8B2S", "9C4A4878-4dac321d8b_02_crop_B07HP93VDJ", "9C4A4861-19626f89e9_04_crop_B07B4MSYPS", "AG8A0630-e5622e17d2_01_crop_B07B85FJD5", "AG8A6719-fc8e1ea686_05_crop_B07DBJ1H18", "9C4A6817-e170a870c0_02_crop_B07WQ4VQ74", "9C4A0132-07352d1dd0_07_crop_B07QGG24Z5", "9C4A8239-7a9d7093e2_04_crop_B0728NWFCG", "AG8A8843-b91f89fff2_05_crop_B07B4YXNR3", "9C4A0286-fb330a56ab_08_crop_B075X4VWP4", "9C4A3359-3edd9ddf7d_02_crop_B0824F6HZ4", "9C4A4668-16193e7517_03_crop_B082VFPXGJ", "AG8A8626-28011c026e_02_crop_B07B7DFS3S", "9C4A0395-ef28332472_02_crop_B07HSKBHBT", "9C4A0307-ca23f47d11_00_crop_B01LR5S6HK", "9C4A5858-0338b2aed1_00_crop_B07HKGY4F2", "AG8A3196-8e1dfd8d95_08_crop_B07WMQ8P8Q"],
        methodsMapping: {
        'shadow_comp_v2_cfg_1_post_color_balanced_denoised': 'γ=1.0 (no guidance)',
        'shadow_comp_v2_default_post_color_balanced_denoised': 'γ=3.0 (default)',
        'shadow_comp_v2_cfg_7_post_color_balanced_denoised': 'γ=7.0',
        },
        folderName: 'figures/ext_cfg',
    });

    makeResultsTable2({
        resultsContainer: document.getElementById('results-container-latent-weight'),
        azimuthSlider: document.getElementById('latent-weight-azimuth-slider'),
        azimuthValueText: document.getElementById('latent-weight-azimuth-value'),
        parameterSlider: document.getElementById('latent-weight-slider'),
        parameterValueText: document.getElementById('latent-weight-value'),
        methods: [
        'shadow_comp_v2_latent_weight_0_post_color_balanced_denoised',
        'shadow_comp_v2_default_post_color_balanced_denoised',
        'shadow_comp_v2_latent_weight_0.2_post_color_balanced_denoised',
        ],
        cropNames: ["AG8A6551-16ae8050c9_06_crop_B075X4QFK2", "9C4A8239-7a9d7093e2_04_crop_B082VLJ7Y2", "9C4A0566-a088c98ccf_05_crop_B07VKM698C", "9C4A3419-2e5c9b4d85_08_crop_B07B4D8B2S", "9C4A4878-4dac321d8b_02_crop_B07HP93VDJ", "9C4A4861-19626f89e9_04_crop_B07B4MSYPS", "AG8A0630-e5622e17d2_01_crop_B07B85FJD5", "AG8A6719-fc8e1ea686_05_crop_B07DBJ1H18", "9C4A6817-e170a870c0_02_crop_B07WQ4VQ74", "9C4A0132-07352d1dd0_07_crop_B07QGG24Z5", "9C4A8239-7a9d7093e2_04_crop_B0728NWFCG", "AG8A8843-b91f89fff2_05_crop_B07B4YXNR3", "9C4A0286-fb330a56ab_08_crop_B075X4VWP4", "9C4A3359-3edd9ddf7d_02_crop_B0824F6HZ4", "9C4A4668-16193e7517_03_crop_B082VFPXGJ", "AG8A8626-28011c026e_02_crop_B07B7DFS3S", "9C4A0395-ef28332472_02_crop_B07HSKBHBT", "9C4A0307-ca23f47d11_00_crop_B01LR5S6HK", "9C4A5858-0338b2aed1_00_crop_B07HKGY4F2", "AG8A3196-8e1dfd8d95_08_crop_B07WMQ8P8Q"],
        methodsMapping: {
        'shadow_comp_v2_latent_weight_0_post_color_balanced_denoised': 'β=0 (no shadow blending)',
        'shadow_comp_v2_default_post_color_balanced_denoised': 'β=0.05 (default)',
        'shadow_comp_v2_latent_weight_0.2_post_color_balanced_denoised': 'β=0.2',
        },
        folderName: 'figures/ext_latent_weight',
    });

    makeResultsTable2({
        resultsContainer: document.getElementById('results-container-light-size'),
        azimuthSlider: document.getElementById('light-size-azimuth-slider'),
        azimuthValueText: document.getElementById('light-size-azimuth-value'),
        parameterSlider: document.getElementById('light-size-slider'),
        parameterValueText: document.getElementById('light-size-value'),
        methods: [
        'shadow_comp_v2_light_radius_0_post_color_balanced_denoised',
        'shadow_comp_v2_default_post_color_balanced_denoised',
        'shadow_comp_v2_light_radius_5_post_color_balanced_denoised',
        ],
        cropNames: ["AG8A4702-1a77809d2c_01_crop_B07DBHFDSQ", "9C4A4475-8f1167988a_07_crop_B07B4ML473", "9C4A0395-ef28332472_09_crop_B075YQ8QKT", "9C4A4878-4dac321d8b_05_crop_B07HSJY1JM", "AG8A0277-069adeb954_07_crop_B07V6M4MSN", "9C4A0132-07352d1dd0_03_crop_B07FJVXVRY", "AG8A8458-c640851baa_05_crop_B075HWR58K", "9C4A0286-fb330a56ab_03_crop_B07HZ1LXVC", "AG8A0630-e5622e17d2_02_crop_B075YMY1PD", "9C4A4878-4dac321d8b_05_crop_B07B7GQ1J2", "AG8A0630-e5622e17d2_02_crop_B0717B4RRW", "9C4A6269-ace1d48e17_00_crop_B07B85FJD5", "9C4A4878-4dac321d8b_01_crop_B075Z8KXB6", "9C4A4861-19626f89e9_08_crop_B082QCZ7YW", "9C4A0132-07352d1dd0_08_crop_B07QHYD995", "9C4A0286-fb330a56ab_03_crop_B07DBFFHXP", "9C4A2857-dc0a9513b2_04_crop_B082VLRCBX", "AG8A1285-e7ec2299e7_08_crop_B07263589M", "9C4A6948-1c80f5988a_08_crop_B07QCQ1J95", "9C4A0370-2d21311d85_05_crop_B07DBD9W9X"],
        methodsMapping: {
        'shadow_comp_v2_light_radius_0_post_color_balanced_denoised': '0',
        'shadow_comp_v2_default_post_color_balanced_denoised': '1',
        'shadow_comp_v2_light_radius_5_post_color_balanced_denoised': '5',
        },
        folderName: 'figures/light_size',
    });
    
    makeResultsTable2({
        resultsContainer:  document.getElementById('results-container-compositing-2d'),
        azimuthSlider: document.getElementById('compositing-2d-azimuth-slider'),
        // azimuthValueText: document.getElementById('compositing-2d-azimuth-value'),
        methods: ['shadow_comp_v2_default_neg_no_shadow_details_transfered_post_color_balanced'],
        initialMethod: 'shadow_comp_v2_default_neg_no_shadow_details_transfered_post_color_balanced',
        cropNames: ['bg-3_obj-5', 'bg-9_obj-1', 'bg-10_obj-11'],
        folderName: 'figures/compositing_2d',
        lightDirections: [
          'x-511_y-300_horizon-100_softness-0.1',
          //'x-511_y-100_horizon-300_softness-0.1',
          'x-511_y-100_horizon-100_softness-0.1',
          'x-384_y-100_horizon-100_softness-0.1',
        // 'x-256_y-300_horizon-100_softness-0.1',
          'x-128_y-100_horizon-100_softness-0.1',
          'x-128_y-300_horizon-100_softness-0.1',
          'x-0_y-300_horizon-100_softness-0.1'
        ],
        initialDirection: 'x-384_y-100_horizon-100_softness-0.1',
        cropSubfolder: true
    });
    makeResultsTable2({
        resultsContainer: document.getElementById('results-container-bg-relight'),
        azimuthSlider: document.getElementById('bg-relight-azimuth-slider'),
        azimuthValueText: document.getElementById('bg-relight-azimuth-value'),
        methods: [
        'relight_shadow_comp_v2_default_composed',
        ],
        cropNames: ["9C4A0132-07352d1dd0_01_crop_B07JVNBJTB", '9C4A0132-07352d1dd0_01_crop_B075X5HBB2'],
        folderName: 'figures/bg_relight',
        cropSubfolder: true
    });
    

  </script>
    <script src="./js/lightbox-plus-jquery.min.js"></script>
    <script src="./js/bootstrap.min.js"></script>
  </body>
</html>
